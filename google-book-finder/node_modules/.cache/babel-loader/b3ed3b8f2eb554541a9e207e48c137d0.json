{"ast":null,"code":"var _jsxFileName = \"/Users/jingchen/Documents/CS_Learning/ChinguProjects/BookFinder/google-book-finder/src/SearchBar.js\";\nimport React from 'react';\nimport BookCardContainer from './BookCardContainer'; //material ui component\n\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport { Typography } from '@material-ui/core';\nimport Grid from \"@material-ui/core/Grid\";\n\nconst styles = theme => ({\n  button: {\n    margin: \"100 px auto\"\n  },\n  input: {\n    display: 'none'\n  },\n  container: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  },\n  textField: {\n    marginLeft: theme.spacing(2),\n    marginRight: theme.spacing(2),\n    flexBasis: 200,\n    display: \"flex\",\n    flexWrap: \"wrap\"\n  },\n  menu: {\n    width: 200\n  }\n});\n\nclass SearchBar extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      booksData: [],\n      totalItems: \"\",\n      query: \"\",\n      isLoading: false,\n      totalPages: 0,\n      currentPageNo: 0\n    };\n\n    this.fetchData = () => {\n      //My unique API key, no authentication needed. \n      //This key is only allowed for Google Books API.\n      const ApiKey = 'AIzaSyAXJai7q64-kw03ojn8H2XVm8AOoTiUrqM';\n      let query = this.state.query.split(\" \").join(\"+\");\n      let maxResults = 80;\n      let booksURL = \"https://www.googleapis.com/books/v1/volumes?q=\".concat(query, \"&maxResults=\").concat(maxResults, \"&key=\").concat(ApiKey, \"&max-result=40\");\n      console.log(booksURL);\n\n      async function getData() {\n        try {\n          const response = await fetch(booksURL);\n          console.log(response);\n\n          if (!response.ok) {\n            throw new Error('Network response was not ok.');\n          } else {\n            let data = await response.json();\n            return data; // data => {\n            //convert into number, get total number of search results\n\n            const totalResults = Number(data.totalItems);\n            const totalPagesCount = this.getPagesCount(totalResults, 20);\n            this.setState({\n              //send books information to state\n              booksData: data.items,\n              totalItems: totalResults,\n              isLoading: false,\n              totalPages: totalPagesCount\n            });\n            console.log(totalPagesCount); // }\n          }\n        } catch (error) {\n          console.log('There has been a problem with your fetch operation: ', error.message);\n        }\n      }\n    };\n\n    this.getPagesCount = (total, denominator) => {\n      const divisible = total % denominator === 0;\n      const valueToBeAdded = divisible ? 0 : 1;\n      return Math.floor(total / denominator) + valueToBeAdded;\n    };\n\n    this.handleChange = name => event => {\n      this.setState({\n        [name]: event.target.value\n      });\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault(); //If query is not an empty string, then fetch data\n\n      if (this.state.query !== \"\") {\n        this.setState({\n          isLoading: true\n        });\n        this.fetchData(); // console.log(this.props.location)\n      }\n    };\n  }\n\n  render() {\n    const classes = this.props.classes;\n    let notice; //Edge case:\n\n    if (this.state.isLoading) {\n      notice = React.createElement(Typography, {\n        variant: \"h3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, \"Searching...\");\n    } else {\n      //If it returns 0 search result\n      if (this.state.totalItems === 0) {\n        notice = React.createElement(Typography, {\n          variant: \"h3\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116\n          },\n          __self: this\n        }, \"No books found.\");\n      } else if (this.state.totalItems !== \"\" || 0) {\n        notice = React.createElement(Typography, {\n          variant: \"h4\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }, this.state.totalItems, \" results. Displaying the first 40 results.\");\n      }\n    }\n\n    return React.createElement(Grid, {\n      container: true,\n      direction: \"row\",\n      justify: \"center\",\n      alignItems: \"center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      item: true,\n      xs: 6,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      className: classes.container,\n      noValidate: true,\n      autoComplete: \"off\",\n      onSubmit: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(TextField, {\n      id: \"search\",\n      label: \"Search for a book...\",\n      className: classes.textField,\n      value: this.state.query,\n      onChange: this.handleChange(\"query\"),\n      margin: \"normal\",\n      variant: \"outlined\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }), React.createElement(Button, {\n      type: \"submit\",\n      variant: \"contained\",\n      size: \"medium\",\n      color: \"primary\",\n      className: classes.button,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, \"Search\"))), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, notice), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, //Edge case: if no book data\n    this.state.totalItems !== 0 && !this.state.isLoading ? React.createElement(BookCardContainer, {\n      books: this.state.booksData,\n      totalItems: this.state.totalItems,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }) : \"\"));\n  }\n\n}\n\nSearchBar.propTypes = {\n  classes: PropTypes.object.isRequired\n};\nexport default withStyles(styles)(SearchBar);","map":{"version":3,"sources":["/Users/jingchen/Documents/CS_Learning/ChinguProjects/BookFinder/google-book-finder/src/SearchBar.js"],"names":["React","BookCardContainer","PropTypes","withStyles","Button","TextField","Typography","Grid","styles","theme","button","margin","input","display","container","flexWrap","textField","marginLeft","spacing","marginRight","flexBasis","menu","width","SearchBar","Component","state","booksData","totalItems","query","isLoading","totalPages","currentPageNo","fetchData","ApiKey","split","join","maxResults","booksURL","console","log","getData","response","fetch","ok","Error","data","json","totalResults","Number","totalPagesCount","getPagesCount","setState","items","error","message","total","denominator","divisible","valueToBeAdded","Math","floor","handleChange","name","event","target","value","handleSubmit","e","preventDefault","render","classes","props","notice","propTypes","object","isRequired"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,iBAAP,MAA8B,qBAA9B,C,CACA;;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,SAASC,UAAT,QAA2B,mBAA3B;AACA,OAAOC,IAAP,MAAiB,wBAAjB;;AAGA,MAAMC,MAAM,GAAGC,KAAK,KAAK;AACrBC,EAAAA,MAAM,EAAE;AACJC,IAAAA,MAAM;AADF,GADa;AAIrBC,EAAAA,KAAK,EAAE;AACHC,IAAAA,OAAO,EAAE;AADN,GAJc;AAOrBC,EAAAA,SAAS,EAAE;AACPD,IAAAA,OAAO,EAAE,MADF;AAEPE,IAAAA,QAAQ,EAAE;AAFH,GAPU;AAWrBC,EAAAA,SAAS,EAAE;AACPC,IAAAA,UAAU,EAAER,KAAK,CAACS,OAAN,CAAc,CAAd,CADL;AAEPC,IAAAA,WAAW,EAAEV,KAAK,CAACS,OAAN,CAAc,CAAd,CAFN;AAGPE,IAAAA,SAAS,EAAE,GAHJ;AAIPP,IAAAA,OAAO,EAAE,MAJF;AAKPE,IAAAA,QAAQ,EAAE;AALH,GAXU;AAkBrBM,EAAAA,IAAI,EAAE;AACFC,IAAAA,KAAK,EAAE;AADL;AAlBe,CAAL,CAApB;;AAuBA,MAAMC,SAAN,SAAwBvB,KAAK,CAACwB,SAA9B,CAAwC;AAAA;AAAA;AAAA,SAEpCC,KAFoC,GAE5B;AACJC,MAAAA,SAAS,EAAE,EADP;AAEJC,MAAAA,UAAU,EAAE,EAFR;AAGJC,MAAAA,KAAK,EAAE,EAHH;AAIJC,MAAAA,SAAS,EAAE,KAJP;AAKJC,MAAAA,UAAU,EAAE,CALR;AAMJC,MAAAA,aAAa,EAAE;AANX,KAF4B;;AAAA,SAYpCC,SAZoC,GAYxB,MAAM;AACd;AACA;AACA,YAAMC,MAAM,GAAG,yCAAf;AACA,UAAIL,KAAK,GAAG,KAAKH,KAAL,CAAWG,KAAX,CAAiBM,KAAjB,CAAuB,GAAvB,EAA4BC,IAA5B,CAAiC,GAAjC,CAAZ;AACA,UAAIC,UAAU,GAAG,EAAjB;AACA,UAAIC,QAAQ,2DAAoDT,KAApD,yBAAwEQ,UAAxE,kBAA0FH,MAA1F,mBAAZ;AACAK,MAAAA,OAAO,CAACC,GAAR,CAAYF,QAAZ;;AACA,qBAAeG,OAAf,GAAyB;AACrB,YAAI;AACA,gBAAMC,QAAQ,GAAG,MAAMC,KAAK,CAACL,QAAD,CAA5B;AACAC,UAAAA,OAAO,CAACC,GAAR,CAAYE,QAAZ;;AACA,cAAI,CAACA,QAAQ,CAACE,EAAd,EAAkB;AACd,kBAAM,IAAIC,KAAJ,CAAU,8BAAV,CAAN;AACH,WAFD,MAEO;AACH,gBAAIC,IAAI,GAAG,MAAMJ,QAAQ,CAACK,IAAT,EAAjB;AACA,mBAAOD,IAAP,CAFG,CAGH;AACA;;AACA,kBAAME,YAAY,GAAGC,MAAM,CAACH,IAAI,CAAClB,UAAN,CAA3B;AACA,kBAAMsB,eAAe,GAAG,KAAKC,aAAL,CAAmBH,YAAnB,EAAiC,EAAjC,CAAxB;AACA,iBAAKI,QAAL,CAAc;AACV;AACAzB,cAAAA,SAAS,EAAEmB,IAAI,CAACO,KAFN;AAGVzB,cAAAA,UAAU,EAAEoB,YAHF;AAIVlB,cAAAA,SAAS,EAAE,KAJD;AAKVC,cAAAA,UAAU,EAAEmB;AALF,aAAd;AAOAX,YAAAA,OAAO,CAACC,GAAR,CAAYU,eAAZ,EAdG,CAeH;AACH;AACJ,SAtBD,CAsBE,OAAOI,KAAP,EAAc;AACZf,UAAAA,OAAO,CAACC,GAAR,CAAY,sDAAZ,EAAoEc,KAAK,CAACC,OAA1E;AACH;AACJ;AACJ,KA/CmC;;AAAA,SAkDpCJ,aAlDoC,GAkDpB,CAACK,KAAD,EAAQC,WAAR,KAAwB;AACpC,YAAMC,SAAS,GAAGF,KAAK,GAAGC,WAAR,KAAwB,CAA1C;AACA,YAAME,cAAc,GAAGD,SAAS,GAAG,CAAH,GAAO,CAAvC;AACA,aAAOE,IAAI,CAACC,KAAL,CAAWL,KAAK,GAAGC,WAAnB,IAAkCE,cAAzC;AACH,KAtDmC;;AAAA,SAwDpCG,YAxDoC,GAwDrBC,IAAI,IAAIC,KAAK,IAAI;AAC5B,WAAKZ,QAAL,CAAc;AACV,SAACW,IAAD,GAAQC,KAAK,CAACC,MAAN,CAAaC;AADX,OAAd;AAGH,KA5DmC;;AAAA,SA8DpCC,YA9DoC,GA8DrBC,CAAC,IAAI;AAChBA,MAAAA,CAAC,CAACC,cAAF,GADgB,CAEhB;;AACA,UAAI,KAAK3C,KAAL,CAAWG,KAAX,KAAqB,EAAzB,EAA6B;AACzB,aAAKuB,QAAL,CAAc;AAAEtB,UAAAA,SAAS,EAAE;AAAb,SAAd;AACA,aAAKG,SAAL,GAFyB,CAGzB;AACH;AACJ,KAtEmC;AAAA;;AAwEpCqC,EAAAA,MAAM,GAAG;AAAA,UACGC,OADH,GACe,KAAKC,KADpB,CACGD,OADH;AAEL,QAAIE,MAAJ,CAFK,CAGL;;AACA,QAAI,KAAK/C,KAAL,CAAWI,SAAf,EAA0B;AACtB2C,MAAAA,MAAM,GAAG,oBAAC,UAAD;AAAY,QAAA,OAAO,EAAC,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAAT;AACH,KAFD,MAEO;AACH;AACA,UAAI,KAAK/C,KAAL,CAAWE,UAAX,KAA0B,CAA9B,EAAiC;AAC7B6C,QAAAA,MAAM,GAAG,oBAAC,UAAD;AAAY,UAAA,OAAO,EAAC,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAT;AACH,OAFD,MAEO,IAAI,KAAK/C,KAAL,CAAWE,UAAX,KAA0B,EAA1B,IAAgC,CAApC,EAAuC;AAC1C6C,QAAAA,MAAM,GAAG,oBAAC,UAAD;AAAY,UAAA,OAAO,EAAC,IAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAA0B,KAAK/C,KAAL,CAAWE,UAArC,+CAAT;AACH;AACJ;;AAED,WACI,oBAAC,IAAD;AAAM,MAAA,SAAS,MAAf;AACI,MAAA,SAAS,EAAC,KADd;AAEI,MAAA,OAAO,EAAC,QAFZ;AAGI,MAAA,UAAU,EAAC,QAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAII,oBAAC,IAAD;AAAM,MAAA,IAAI,MAAV;AAAW,MAAA,EAAE,EAAE,CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAM,MAAA,SAAS,EAAE2C,OAAO,CAACxD,SAAzB;AAAoC,MAAA,UAAU,MAA9C;AAA+C,MAAA,YAAY,EAAC,KAA5D;AAAkE,MAAA,QAAQ,EAAE,KAAKoD,YAAjF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,SAAD;AACI,MAAA,EAAE,EAAC,QADP;AAEI,MAAA,KAAK,EAAC,sBAFV;AAGI,MAAA,SAAS,EAAEI,OAAO,CAACtD,SAHvB;AAII,MAAA,KAAK,EAAE,KAAKS,KAAL,CAAWG,KAJtB;AAKI,MAAA,QAAQ,EAAE,KAAKiC,YAAL,CAAkB,OAAlB,CALd;AAMI,MAAA,MAAM,EAAC,QANX;AAOI,MAAA,OAAO,EAAC,UAPZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAUI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAVJ,EAWI,oBAAC,MAAD;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAsB,MAAA,OAAO,EAAC,WAA9B;AAA0C,MAAA,IAAI,EAAC,QAA/C;AAAwD,MAAA,KAAK,EAAC,SAA9D;AAAwE,MAAA,SAAS,EAAES,OAAO,CAAC5D,MAA3F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAXJ,CADJ,CAJJ,EAqBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK8D,MADL,CArBJ,EAwBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEQ;AACC,SAAK/C,KAAL,CAAWE,UAAX,KAA0B,CAA1B,IAA+B,CAAC,KAAKF,KAAL,CAAWI,SAA5C,GACI,oBAAC,iBAAD;AAAmB,MAAA,KAAK,EAAE,KAAKJ,KAAL,CAAWC,SAArC;AAAgD,MAAA,UAAU,EAAE,KAAKD,KAAL,CAAWE,UAAvE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,GAGI,EANZ,CAxBJ,CADJ;AAqCH;;AA5HmC;;AAgIxCJ,SAAS,CAACkD,SAAV,GAAsB;AAClBH,EAAAA,OAAO,EAAEpE,SAAS,CAACwE,MAAV,CAAiBC;AADR,CAAtB;AAIA,eAAexE,UAAU,CAACK,MAAD,CAAV,CAAmBe,SAAnB,CAAf","sourcesContent":["import React from 'react';\nimport BookCardContainer from './BookCardContainer';\n//material ui component\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport { Typography } from '@material-ui/core';\nimport Grid from \"@material-ui/core/Grid\";\n\n\nconst styles = theme => ({\n    button: {\n        margin: `100 px auto`,\n    },\n    input: {\n        display: 'none',\n    },\n    container: {\n        display: 'flex',\n        flexWrap: 'wrap',\n    },\n    textField: {\n        marginLeft: theme.spacing(2),\n        marginRight: theme.spacing(2),\n        flexBasis: 200,\n        display: \"flex\",\n        flexWrap: \"wrap\"\n    },\n    menu: {\n        width: 200,\n    },\n});\n\nclass SearchBar extends React.Component {\n\n    state = {\n        booksData: [],\n        totalItems: \"\",\n        query: \"\",\n        isLoading: false,\n        totalPages: 0,\n        currentPageNo: 0\n    }\n\n    //fetch google books data when submitting search form\n    fetchData = () => {\n        //My unique API key, no authentication needed. \n        //This key is only allowed for Google Books API.\n        const ApiKey = 'AIzaSyAXJai7q64-kw03ojn8H2XVm8AOoTiUrqM';\n        let query = this.state.query.split(\" \").join(\"+\");\n        let maxResults = 80;\n        let booksURL = `https://www.googleapis.com/books/v1/volumes?q=${query}&maxResults=${maxResults}&key=${ApiKey}&max-result=40`;\n        console.log(booksURL)\n        async function getData() {\n            try {\n                const response = await fetch(booksURL);\n                console.log(response)\n                if (!response.ok) {\n                    throw new Error('Network response was not ok.');\n                } else {\n                    let data = await response.json()\n                    return data;\n                    // data => {\n                    //convert into number, get total number of search results\n                    const totalResults = Number(data.totalItems)\n                    const totalPagesCount = this.getPagesCount(totalResults, 20)\n                    this.setState({\n                        //send books information to state\n                        booksData: data.items,\n                        totalItems: totalResults,\n                        isLoading: false,\n                        totalPages: totalPagesCount,\n                    })\n                    console.log(totalPagesCount)\n                    // }\n                }\n            } catch (error) {\n                console.log('There has been a problem with your fetch operation: ', error.message);\n            }\n        }\n    }\n\n    //To display all results, need to get page count first\n    getPagesCount = (total, denominator) => {\n        const divisible = total % denominator === 0;\n        const valueToBeAdded = divisible ? 0 : 1;\n        return Math.floor(total / denominator) + valueToBeAdded;\n    }\n\n    handleChange = name => event => {\n        this.setState({\n            [name]: event.target.value\n        })\n    }\n\n    handleSubmit = e => {\n        e.preventDefault()\n        //If query is not an empty string, then fetch data\n        if (this.state.query !== \"\") {\n            this.setState({ isLoading: true })\n            this.fetchData()\n            // console.log(this.props.location)\n        }\n    }\n\n    render() {\n        const { classes } = this.props;\n        let notice;\n        //Edge case:\n        if (this.state.isLoading) {\n            notice = <Typography variant=\"h3\">Searching...</Typography>\n        } else {\n            //If it returns 0 search result\n            if (this.state.totalItems === 0) {\n                notice = <Typography variant=\"h3\">No books found.</Typography>\n            } else if (this.state.totalItems !== \"\" || 0) {\n                notice = <Typography variant=\"h4\">{this.state.totalItems} results. Displaying the first 40 results.</Typography>\n            }\n        }\n\n        return (\n            <Grid container\n                direction=\"row\"\n                justify=\"center\"\n                alignItems=\"center\">\n                <Grid item xs={6}>\n                    <form className={classes.container} noValidate autoComplete=\"off\" onSubmit={this.handleSubmit}>\n                        <TextField\n                            id=\"search\"\n                            label=\"Search for a book...\"\n                            className={classes.textField}\n                            value={this.state.query}\n                            onChange={this.handleChange(\"query\")}\n                            margin=\"normal\"\n                            variant=\"outlined\"\n                        />\n                        <br></br>\n                        <Button type=\"submit\" variant=\"contained\" size=\"medium\" color=\"primary\" className={classes.button}>\n                            Search\n                    </Button>\n                    </form>\n                </Grid>\n                <p>\n                    {notice}\n                </p>\n                <div>\n                    {\n                        //Edge case: if no book data\n                        (this.state.totalItems !== 0 && !this.state.isLoading) ?\n                            <BookCardContainer books={this.state.booksData} totalItems={this.state.totalItems} />\n                            :\n                            \"\"\n                    }\n                </div>\n\n            </Grid>\n        )\n    }\n\n}\n\nSearchBar.propTypes = {\n    classes: PropTypes.object.isRequired\n};\n\nexport default withStyles(styles)(SearchBar);\n"]},"metadata":{},"sourceType":"module"}